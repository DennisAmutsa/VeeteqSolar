{% extends "admin_base.html" %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <div class="mb-6 sm:mb-8">
        <a href="{{ url_for('admin_team') }}" class="text-solar-green hover:text-solar-blue font-medium mb-4 inline-flex items-center">
            <i class="fas fa-arrow-left mr-2"></i> Back to Team Management
        </a>
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Edit Team Member</h1>
        <p class="text-gray-600">Update details for {{ member.name }}</p>
    </div>

    <div class="bg-white rounded-xl shadow-lg border border-gray-100 p-6 sm:p-8">
        <form action="{{ url_for('admin_edit_team_member', member_id=member.id) }}" method="POST" enctype="multipart/form-data">
            <div class="grid grid-cols-1 gap-6">
                <!-- Name -->
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                    <input type="text" name="name" id="name" value="{{ member.name }}" required class="w-full rounded-lg border-gray-300 focus:border-solar-green focus:ring-solar-green shadow-sm" placeholder="e.g. Jane Doe">
                </div>
                
                <!-- Role -->
                <div>
                    <label for="role" class="block text-sm font-medium text-gray-700 mb-1">Role / Job Title</label>
                    <input type="text" name="role" id="role" value="{{ member.role }}" required class="w-full rounded-lg border-gray-300 focus:border-solar-green focus:ring-solar-green shadow-sm" placeholder="e.g. Senior Technician">
                </div>
                
                <!-- Bio -->
                <div>
                    <label for="bio" class="block text-sm font-medium text-gray-700 mb-1">Short Bio</label>
                    <textarea name="bio" id="bio" rows="3" class="w-full rounded-lg border-gray-300 focus:border-solar-green focus:ring-solar-green shadow-sm" placeholder="e.g. 5+ years of experience in...">{{ member.bio }}</textarea>
                    <p class="text-xs text-gray-500 mt-1">Keep it concise (1-2 sentences recommended)</p>
                </div>
                
                <!-- Background Color Badge -->
                <div>
                    <label for="bg_color" class="block text-sm font-medium text-gray-700 mb-2">Role Badge Color</label>
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                        <label class="cursor-pointer relative">
                            <input type="radio" name="bg_color" value="solar-blue" {% if member.bg_color == 'solar-blue' %}checked{% endif %} class="sr-only peer">
                            <div class="flex items-center justify-center p-3 rounded-lg border peer-checked:border-2 peer-checked:border-solar-blue bg-blue-50 hover:bg-blue-100 transition">
                                <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full font-bold">Blue</span>
                            </div>
                            <div class="absolute top-1 right-1 w-2 h-2 bg-solar-blue rounded-full opacity-0 peer-checked:opacity-100"></div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="bg_color" value="solar-green" {% if member.bg_color == 'solar-green' %}checked{% endif %} class="sr-only peer">
                            <div class="flex items-center justify-center p-3 rounded-lg border peer-checked:border-2 peer-checked:border-solar-green bg-green-50 hover:bg-green-100 transition">
                                <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full font-bold">Green</span>
                            </div>
                            <div class="absolute top-1 right-1 w-2 h-2 bg-solar-green rounded-full opacity-0 peer-checked:opacity-100"></div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="bg_color" value="solar-orange" {% if member.bg_color == 'solar-orange' %}checked{% endif %} class="sr-only peer">
                            <div class="flex items-center justify-center p-3 rounded-lg border peer-checked:border-2 peer-checked:border-solar-orange bg-orange-50 hover:bg-orange-100 transition">
                                <span class="bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full font-bold">Orange</span>
                            </div>
                            <div class="absolute top-1 right-1 w-2 h-2 bg-solar-orange rounded-full opacity-0 peer-checked:opacity-100"></div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="bg_color" value="solar-yellow" {% if member.bg_color == 'solar-yellow' %}checked{% endif %} class="sr-only peer">
                            <div class="flex items-center justify-center p-3 rounded-lg border peer-checked:border-2 peer-checked:border-solar-yellow bg-yellow-50 hover:bg-yellow-100 transition">
                                <span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full font-bold">Yellow</span>
                            </div>
                            <div class="absolute top-1 right-1 w-2 h-2 bg-solar-yellow rounded-full opacity-0 peer-checked:opacity-100"></div>
                        </label>
                    </div>
                </div>
                
                <!-- Display Order -->
                <div>
                    <label for="display_order" class="block text-sm font-medium text-gray-700 mb-1">Display Order</label>
                    <input type="number" name="display_order" id="display_order" min="1" value="{{ member.display_order }}" class="w-full rounded-lg border-gray-300 focus:border-solar-emerald focus:ring-solar-emerald shadow-sm">
                    <p class="text-xs text-gray-500 mt-1">Lower numbers appear first</p>
                </div>
                
                <!-- Image Upload -->
                <div>
                    <label for="image" class="block text-sm font-medium text-gray-700 mb-1">Profile Photo (Leave empty to keep current)</label>
                    <div class="flex items-start space-x-4">
                        {% if member.image_url %}
                        <div class="flex-shrink-0">
                            <img src="{{ url_for('static', filename='uploads/' + member.image_url) }}" alt="Current Photo" class="h-20 w-20 object-cover rounded-full border border-gray-200">
                            <p class="text-xs text-gray-500 text-center mt-1">Current</p>
                        </div>
                        {% endif %}
                        
                        <div class="flex-grow mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg hover:border-solar-emerald transition duration-300">
                            <div class="space-y-1 text-center">
                                <i class="fas fa-image text-gray-400 text-4xl mb-3"></i>
                                <div class="flex text-sm text-gray-600">
                                    <label for="image" class="relative cursor-pointer bg-white rounded-md font-medium text-solar-emerald hover:text-solar-teal focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-solar-emerald">
                                        <span>Upload a new file</span>
                                        <input id="image" name="image" type="file" class="sr-only" accept="image/*" onchange="previewImage(this)">
                                    </label>
                                    <p class="pl-1">to replace</p>
                                </div>
                                <p class="text-xs text-gray-500">PNG, JPG, GIF up to 5MB</p>
                            </div>
                        </div>
                    </div>
                    <!-- Image Preview -->
                    <div id="imagePreview" class="mt-4 hidden text-center">
                        <p class="text-sm font-medium text-gray-700 mb-2">New Image Preview:</p>
                        <img id="preview" src="#" alt="Image Preview" class="mx-auto h-32 w-32 object-cover rounded-full border-4 border-solar-emerald">
                        <p class="text-xs text-gray-500 mt-2" id="fileName"></p>
                    </div>
                </div>
                
                <!-- Submit Button -->
                <div class="pt-4">
                    <button type="submit" class="w-full bg-gradient-to-r from-solar-green to-solar-blue text-white py-3 rounded-lg font-bold shadow-lg hover:shadow-xl transition duration-300 transform hover:-translate-y-1">
                        <i class="fas fa-save mr-2"></i> Update Team Member
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    function previewImage(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            
            reader.onload = function(e) {
                document.getElementById('preview').src = e.target.result;
                document.getElementById('imagePreview').classList.remove('hidden');
                document.getElementById('fileName').textContent = input.files[0].name;
            }
            
            reader.readAsDataURL(input.files[0]);
        }
    }
</script>
{% endblock %}
